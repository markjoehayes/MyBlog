{% extends 'base.html' %}
{% block content %}
    <h2>{% block title %} {{ post['title' ]}}{% endblock %}</h2>
    <span class="badge badge-primary">{{ post['created'] }}</span>
    <p>{{ post['content'] }}</p>

    <!-- Comments Section -->
    <h3>Comments ({{ comments|length }})</h3>

    <!-- comments form -->
    <div class="card mt-4">
        <div class="card-body">
            <h5 class="card-title">Add a Comment</h5>
            <form method="POST" action="{{ url_for('add_comment_route', post_id=post['id']) }}">
                <div class="mb-3">
                    <label for="author" class="form-label">Your Name</label>
                    <input type="text" class="form-control" id="author" name="author" required>
                </div>
                <div class="mb-3">
                    <label for="content" class="form-label">Your Comment</label>
                    <textarea class="form-control" id="content" name="content" rows="3" required></textarea>
                 </div>
                 <button type="submit" class="btn btn-success">Submit Comment</button>
            </form>
        </div>    
    </div>

    <!-- comments list -->
    <div class="mt-4">
        {% for comment in comments %}
        <div class="card mb-3">
            <div class="card-body">
                <h6 class="card-title">{{ comment['author'] }}</h6>
                <p class="card-text">{{ comment['content'] }}</p>
                <p class="text-muted small">{{ comment['created'] }}</p>
                <a href="{{ url_for('delete_comment', comment_id=comment['id']) }}"
                    class="btn btn-outline-danger btn-sm"
                    onclick="return confirm('Are you sure you want to delete this comment?')">
                    Delete
                </a>
            </div>    
        </div>    
        {% else %}
        <p class="text-muted">No comments yet, Be the first to comment!</p>
        {% endfor%}
    </div>
{% endblock %}
